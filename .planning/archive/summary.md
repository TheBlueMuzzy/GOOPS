# .planning-v2 Validation Summary

**Date:** 2026-01-25
**Validated Against:** master branch (commit fb87882)

---

## High-Level Changes

### Version Discrepancy Fixed
- **Docs claimed:** v1.1.51
- **Actual (MainMenu.tsx):** v1.1.13
- **Updated all references to:** v1.1.13

### Test Count Updated
- **Docs claimed:** 110-112 tests
- **Actual:** 150 tests across 7 test files
- **New test files added:**
  - `crackSystem.test.ts` (17 tests)
  - `pieceUtils.test.ts` (21 tests)
  - `gameLogic.test.ts` grew from 30 to 32 tests

### Phase Count Corrected
- **Docs claimed:** 18 phases, 49 plans
- **Actual:** 20 phases, 53 plans
- **Added phases 19-20 to v1.2 milestone:**
  - Phase 19: Multi-Color Pieces (3 plans)
  - Phase 20: Expanding Cracks Overhaul (1 plan)

### File Size Changes
| File | Documented | Actual | Reason |
|------|------------|--------|--------|
| GameEngine.ts | ~576 lines | ~1177 lines | Crack system added |
| GameBoard.tsx | ~604 lines | ~758 lines | Multi-color rendering |
| Art.tsx | ~581 lines | ~543 lines | Minor cleanup |

### XP Curve Confirmed
- Formula: `3500 + (rank * 250)` per rank
- Verified in `utils/progression.ts`
- Much flatter than original exponential curve

### Upgrade Count Confirmed
- 20 upgrades across 4 bands
- Verified in `constants.ts`

---

## Files Updated

### Root Level
| File | Changes |
|------|---------|
| HOME.md | Version 1.1.51 → 1.1.13, status updated |
| PROJECT.md | Phase count 18→20, plan count 49→53, version fixed |
| STATE.md | Version 1.1.51 → 1.1.13, removed GoopPieceRework branch reference |
| ROADMAP.md | Added Phase 19-20, fixed v1.2 summary (14→18 plans, 112→150 tests) |
| MILESTONES.md | Updated v1.2 stats (14-20 phases, 18 plans, 150 tests) |
| DESIGN_VISION.md | Replaced "Phase 5 Current" with implementation status, added XP curve |
| SYSTEM-INVENTORY.md | XP curve fixed, test count 65→150, marked implemented features |

### codebase/ Directory
| File | Changes |
|------|---------|
| ARCHITECTURE.md | GameEngine 576→1177 lines, added tickCrackGrowth |
| STRUCTURE.md | Test count 110→150, added 2 new test files, GameEngine line count |
| TESTING.md | Test count 110→150, added pieceUtils and crackSystem test descriptions |
| CONCERNS.md | GameEngine 465→1177 lines, test count 36→150, marked features complete |
| STACK.md | No changes needed (accurate) |
| CONVENTIONS.md | No changes needed (accurate) |
| INTEGRATIONS.md | No changes needed (accurate) |

### milestones/ Directory
| File | Changes |
|------|---------|
| v1.0-ROADMAP.md | No changes needed (accurate) |
| v1.1-ROADMAP.md | No changes needed (accurate) |
| v1.2-ROADMAP.md | Added Phases 19-20, updated stats (14→18 plans) |

---

## Discrepancies Explained

### Why Version Shows 1.1.13 (Not 1.1.51)
The STATE.md mentioned v1.1.51, but the actual deployed code in MainMenu.tsx shows v1.1.13. The session notes in STATE.md described work done in versions 1.1.46-1.1.51, but these version bumps may not have been committed to the version display. The master branch reflects 1.1.13 as the canonical version.

### Why GameEngine Grew So Much
Phase 20 (Expanding Cracks Overhaul) added significant crack system logic:
- CrackCell data structure with parent/child relationships
- Per-cell growth timers
- Connected component counting
- Merge behavior for same-color cracks
- tickCrackGrowth() method

The file went from ~576 lines to ~1177 lines (doubled).

### Why Phase 19 Plans Don't Exist
Phase 19 (Multi-Color Pieces) was completed but plan files were not created in `.planning-v2/plans/`. The work was done based on existing requirements. Added retrospective documentation to v1.2-ROADMAP.md.

---

## Recommendations

1. **Consider extracting CrackManager** - GameEngine at 1177 lines is getting large
2. **Update version display** - Sync MainMenu.tsx version with actual release
3. **Create plan templates** - Ensure all future phases have plan files

---

## Verification Commands

```bash
# Tests pass
npm run test:run
# Output: 150 tests across 7 files

# Version in code
grep -r "v1\." components/MainMenu.tsx
# Output: v1.1.13

# Upgrade count
grep -c "id:" constants.ts
# Output: 20

# File line counts
wc -l core/GameEngine.ts components/GameBoard.tsx components/Art.tsx
# Output: 1177, 758, 543
```

---

*Generated by Claude Code validation on 2026-01-25*
