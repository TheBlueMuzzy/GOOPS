---
phase: 33-rank-0-training-sequence
plan: 03
type: execute
---

<objective>
Write intercom messages for all 17 training steps and update journal page content to reflect what's taught in each phase.

Purpose: The training infrastructure (33-01 data model, 33-02 engine/flow controller) is in place but has no content. Each of the 17 steps in `TRAINING_SEQUENCE` needs an `IntercomMessage` (keywords + fullText) so the garble renderer has something to display. Journal pages need substantive content reflecting what the player actually experiences.

Output: Updated `data/tutorialSteps.ts` with 17 intercom messages mapped to training steps, updated `data/journalEntries.ts` with richer training-relevant content, `TEXT_MANIFEST.md` synced.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context:
@.planning/phases/31-tutorial-infrastructure/31-02-SUMMARY.md
@.planning/phases/32-journal-system/32-01-SUMMARY.md
@.planning/phases/33-rank-0-training-sequence/33-01-SUMMARY.md
@.planning/phases/33-rank-0-training-sequence/33-02-SUMMARY.md

# Relevant source files:
@types/tutorial.ts
@types/training.ts
@data/tutorialSteps.ts
@data/trainingScenarios.ts
@data/journalEntries.ts
@components/IntercomText.tsx
@components/IntercomMessage.tsx
@hooks/useTrainingFlow.ts

# Text reference:
@TEXT_MANIFEST.md

**Tech stack available:**
- IntercomMessage type: { keywords: string[], fullText: string }
- IntercomText garble renderer: non-keyword words → seeded static chars (░▒▓█), keywords → green-400 clear text
- Typewriter reveal: ~35ms/char, tap to skip
- JournalPage: { id, title, icon, unlockedBy: TutorialStepId | 'ALWAYS', sections[] }
- Typography: t-body (18px min), t-heading (24px), t-display (36px for intercom)

**Established patterns:**
- Intercom rendered at 36px body, 18px header, in maintenance-order style (slate-900, green accents)
- Garble charset: ░▒▓█▐▌╪╫╬─│┤├┬┴┼
- Seeded PRNG for stable garble
- Journal accordion with single-expanded-section pattern

**The 17-step training sequence (from data/trainingScenarios.ts):**
Each step needs an IntercomMessage. The training flow controller shows the message when the step activates.

Phase A — Console Briefing:
  A1_BRIEFING (tap to advance, marks WELCOME)
  A2_PERISCOPE (action: drag-periscope)

Phase B — Goop Basics:
  B1_GOOP_INTRO (event: piece-landed, autoFall blue mono)
  B2_FAST_FALL (action: fast-fall, slowFall blue mono)
  B3_PIECE_ROTATION (action: rotate-piece, yellow tri, marks DROP_INTRO)

Phase C — Popping & Merging:
  C1_POP_INTRO (action: pop-goop, blue duo, pressureRate 0.2)
  C2_MERGE (event: goop-merged, automatic)
  C3_FILL_TIMING (tap, showPressureLine, marks POP_TIMING)

Phase D — Cracks & Color Matching:
  D1_CRACK_APPEARS (tap, green crack near-stack, marks CRACK_INTRO)
  D2_TANK_ROTATION (action: rotate-tank, green mono, marks ROTATE_INTRO)

Phase E — Pressure Mastery:
  E1_PRESSURE_REVEAL (tap, pressureRate 0.3)
  E2_PRESSURE_THRESHOLD (tap)
  E3_SUCCESSFUL_POP (event: pop-complete, pressureRate 0.5)

Phase F — Crack Sealing Payoff:
  F1_CRACK_SEAL (action: pop-goop)

Phase G — Scaffolding & Spatial Awareness:
  G1_OFFSCREEN_CRACK (action: rotate-tank, red crack high-offscreen, marks WRAP_INTRO)
  G2_SCAFFOLDING (event: crack-sealed, red tri)
  G3_SCAFFOLDING_TRADEOFF (tap, marks FIRST_SHIFT)

**Narrative tone (from PRD):**
- Corporate onboarding: mundane, grungy, uncaring
- Employer speaks through low-quality intercom/PA system
- Static corrupts most words, key terms come through clearly
- Bored safety trainer voice — short sentences, dry
- Key terms = the mechanic being taught (these become keywords array)

**Constraining decisions:**
- Phase 33-01: Content defined separately from data model. Messages stored in tutorialSteps.ts.
- Phase 33-02: useTrainingFlow reads messages from a mapping (training step → intercom message)
- Phase 32: Journal unlock triggers mapped via markComplete field in TrainingStep → TutorialStepId → JournalPage.unlockedBy
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write intercom messages for all 17 training steps</name>
  <files>data/tutorialSteps.ts, types/tutorial.ts</files>
  <action>
Replace the 2 placeholder steps in `data/tutorialSteps.ts` with entries for all 17 training steps. Each entry maps a TrainingStepId to an IntercomMessage (keywords + fullText).

**Architecture decision:** The training flow controller (useTrainingFlow) needs to look up intercom messages by TrainingStepId. The existing TUTORIAL_STEPS array uses the TutorialStep type (id: TutorialStepId, trigger, rank, etc.) which is the Phase 31 tutorial state machine format. The training system uses a different TrainingStepId type.

**Approach:** Create a new export `TRAINING_MESSAGES: Record<TrainingStepId, IntercomMessage>` alongside the existing TUTORIAL_STEPS. Import TrainingStepId from types/training.ts and IntercomMessage from types/tutorial.ts. This keeps the Phase 31 tutorial step infrastructure intact while adding the training-specific message content.

Do NOT modify or remove the existing TUTORIAL_STEPS array — it's used by the useTutorial hook for rank-based and event-based triggers. The training messages are a separate lookup.

**Message content — corporate safety trainer voice. Short. Dry. Keywords are the mechanic terms:**

```
A1_BRIEFING:
  keywords: ["operator", "safety training", "shift"]
  fullText: "Welcome aboard, operator. Standard safety training is mandatory before your first shift. Pay attention."

A2_PERISCOPE:
  keywords: ["periscope", "tank", "drag"]
  fullText: "Use the periscope to look inside the tank. Drag it down to enter."

B1_GOOP_INTRO:
  keywords: ["goop", "extruder", "tank"]
  fullText: "The goop extruder drops material into the tank. Watch where it lands."

B2_FAST_FALL:
  keywords: ["hold down", "speed up", "drop"]
  fullText: "Hold down to speed up the drop. Or just tap to slam it down. Your call."

B3_PIECE_ROTATION:
  keywords: ["rotate", "piece", "Q", "E"]
  fullText: "Rotate the piece before it lands. Q and E keys, or tap the screen edges."

C1_POP_INTRO:
  keywords: ["pop", "goop", "pressure", "tap"]
  fullText: "Too much goop builds pressure. Tap solid goop to pop it and vent the tank."

C2_MERGE:
  keywords: ["same color", "merges", "bigger"]
  fullText: "Same color goop merges together into bigger blobs. Bigger pops vent more pressure."

C3_FILL_TIMING:
  keywords: ["solid", "fill", "pop"]
  fullText: "Fresh goop needs time to solidify. You can only pop solid goop. The pressure line shows the threshold."

D1_CRACK_APPEARS:
  keywords: ["crack", "matching", "seal"]
  fullText: "A crack in the tank wall. Only matching color goop can seal it. That is literally your one job."

D2_TANK_ROTATION:
  keywords: ["rotate", "tank", "swipe", "A", "D"]
  fullText: "The goop is not above the crack. Rotate the tank to line it up. Swipe or use A and D keys."

E1_PRESSURE_REVEAL:
  keywords: ["pressure", "rising", "goop"]
  fullText: "Notice the pressure gauge. Every piece of goop in the tank adds to it. If it hits maximum capacity, you fail."

E2_PRESSURE_THRESHOLD:
  keywords: ["pressure line", "above", "pop"]
  fullText: "Goop can only be popped when the pressure line rises above it. Watch the line climb."

E3_SUCCESSFUL_POP:
  keywords: ["pop", "pressure drops", "bonus"]
  fullText: "There. Pressure drops when you pop. Bigger groups drop it more. Popping also scores a bonus."

F1_CRACK_SEAL:
  keywords: ["seal", "crack", "massive", "pressure relief"]
  fullText: "The green goop is sitting on the green crack. Pop it to seal the crack. Sealed cracks give massive pressure relief."

G1_OFFSCREEN_CRACK:
  keywords: ["wraps around", "rotate", "360"]
  fullText: "The tank is a cylinder. It wraps around. Keep rotating to see everything. There is more tank than you think."

G2_SCAFFOLDING:
  keywords: ["stack", "scaffolding", "reach", "higher"]
  fullText: "That crack is too high to reach from the floor. Stack pieces as scaffolding to reach it."

G3_SCAFFOLDING_TRADEOFF:
  keywords: ["balance", "scaffolding", "pressure"]
  fullText: "More goop means more pressure. But sometimes you need scaffolding to reach the cracks. Balance is everything. Training complete."
```

**Implementation:**
1. Add `import { TrainingStepId } from '../types/training';` to tutorialSteps.ts
2. Add `import { IntercomMessage } from '../types/tutorial';`
3. Create and export `TRAINING_MESSAGES: Record<TrainingStepId, IntercomMessage>` with all 17 entries
4. Keep the existing TUTORIAL_STEPS array unchanged (it's the Phase 31 system)
  </action>
  <verify>Run `npm run test:run` — all tests pass, no TS errors. Verify TRAINING_MESSAGES has exactly 17 entries matching all TrainingStepId values.</verify>
  <done>TRAINING_MESSAGES record exported with 17 intercom messages. Each has keywords (mechanic terms) and fullText (bored corporate trainer voice). Existing TUTORIAL_STEPS preserved.</done>
</task>

<task type="auto">
  <name>Task 2: Update journal entries with training-relevant content</name>
  <files>data/journalEntries.ts, TEXT_MANIFEST.md</files>
  <action>
Update the first 6 journal pages in `data/journalEntries.ts` to better reflect what the player actually experiences in training. The pages are already structured correctly — just improve the section content to be more useful as a reference.

**Content updates (keep language short, direct, practical — it's a reference document):**

**BASICS** (always visible) — update sections:
- "PRESSURE SYSTEM": Keep current text, it's good.
- "POPPING BASICS": Keep current text, it's good.
- Add section: "YOUR OBJECTIVE" — "Seal all cracks before the shift timer runs out. Cracks appear in the tank walls. Place matching-color goop on a crack, then pop it to seal."

**CONTROLS** (unlocks on ROTATE_INTRO) — already has good content, minor tweaks:
- "TANK ROTATION": Update to "Swipe left/right or A/D keys to rotate the tank. The tank is a cylinder — it wraps all the way around."
- Keep other sections as-is.

**POPPING** (unlocks on POP_TIMING) — update sections:
- "WHAT CAN BE POPPED": Update to "Only fully solid goop below the pressure line can be popped. Fresh goop needs time to solidify — watch it fill in."
- "TIMING TENSION": Keep current text, it's good.
- Add section: "MERGING" — "Same-color goop touching each other merges into bigger blobs. Bigger pops vent more pressure and score more points."

**CRACKS** (unlocks on CRACK_INTRO) — update sections:
- "SEALING CRACKS": Update to "Place matching-color goop on a crack and pop it. Sealed cracks give a massive pressure drop. This is the core of your job."
- Keep "CRACKS SPREAD" as-is.

**WRAPPING** (unlocks on WRAP_INTRO) — update sections:
- "THE TANK WRAPS": Update to "The tank is a full cylinder. Goop on the left edge connects to goop on the right edge. Rotate all the way around to see everything."
- Keep "CROSS-SEAM CONNECTIONS" as-is.

**SCORING** (unlocks on FIRST_SHIFT) — update sections:
- Add section: "SHIFTS" — "Each shift lasts 75 seconds. Seal all assigned cracks before time runs out."
- Keep existing sections.

**Do NOT modify stub pages (COMPLICATIONS_*, UPGRADES, ABILITIES)** — those are for Phases 35-36.

Also update TEXT_MANIFEST.md with any new/changed text strings.
  </action>
  <verify>Run `npm run test:run` — all tests pass, no TS errors.</verify>
  <done>Journal pages BASICS through WRAPPING updated with practical training content. New sections added where needed. TEXT_MANIFEST.md synced. Stub pages untouched.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run test:run` passes all existing tests
- [ ] No TypeScript errors
- [ ] TRAINING_MESSAGES has exactly 17 entries (one per TrainingStepId)
- [ ] All messages have keywords (mechanic terms) and fullText (corporate trainer voice)
- [ ] Journal pages have substantive, practical content
- [ ] TEXT_MANIFEST.md reflects all text changes
- [ ] Narrative voice is consistent (bored corporate trainer)
</verification>

<success_criteria>

- TRAINING_MESSAGES record with 17 intercom messages exported
- Each message follows garble-friendly format (keywords are the mechanic terms)
- Journal pages reflect what player actually learns in training
- Existing TUTORIAL_STEPS array preserved (Phase 31 system)
- TEXT_MANIFEST.md kept in sync
- No regressions in existing tests
</success_criteria>

<output>
After completion, create `.planning/phases/33-rank-0-training-sequence/33-03-SUMMARY.md`
</output>
