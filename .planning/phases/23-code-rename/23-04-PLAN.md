---
phase: 23-code-rename
plan: 04
type: execute
---

<objective>
Rename Complication system types and action constants.

Purpose: Establish TankSystem terminology for complications and update action names.
Output: ComplicationType -> TankSystem, action constants renamed to match glossary.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/GLOSSARY.md
@.planning/phases/23-code-rename/23-03-SUMMARY.md

**Key files to modify:**
@types.ts - ComplicationType definition
@core/ComplicationManager.ts - Heavy usage (21 refs)
@core/GameEngine.ts - State and logic (14 refs)
@components/GameBoard.tsx - UI display (11 refs)
@core/commands/actions.ts - Action definitions
@core/events/GameEvents.ts - Event types

**Migration targets:**
- ComplicationType -> TankSystem (79 refs)
- laserCapacitor -> laserCharge (12 refs)
- primedGroups -> prePoppedGoopGroups (10 refs)
- groupId -> goopGroupId (62 refs)
- MOVE_BOARD -> SPIN_TANK
- ROTATE_PIECE -> ROTATE_GOOP
- BLOCK_TAP -> POP_GOOP
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename ComplicationType to TankSystem</name>
  <files>types.ts, core/ComplicationManager.ts, core/GameEngine.ts, components/GameBoard.tsx, complicationConfig.ts</files>
  <action>
    1. In types.ts:
       - Rename `enum ComplicationType` or `type ComplicationType` to `TankSystem`
       - Keep the enum values (LASER, LIGHTS, CONTROLS) - they're already good

    2. Update all usages (79 refs):
       - ComplicationManager.ts (21 refs) - heavy lifting here
       - GameEngine.ts (14 refs)
       - GameBoard.tsx (11 refs)
       - complicationConfig.ts
       - Other files as needed

    Note: This is a type rename only. The enum VALUES stay the same.
  </action>
  <verify>grep -r "ComplicationType" --include="*.ts" --include="*.tsx" . | grep -v node_modules returns no matches</verify>
  <done>ComplicationType -> TankSystem complete.</done>
</task>

<task type="auto">
  <name>Task 2: Rename laser and primed terminology</name>
  <files>core/GameEngine.ts, core/ComplicationManager.ts, components/GameBoard.tsx, types.ts</files>
  <action>
    1. Rename laserCapacitor -> laserCharge (12 refs):
       - State field in GameEngine
       - UI display in GameBoard
       - Logic in ComplicationManager

    2. Rename primedGroups -> prePoppedGoopGroups (10 refs):
       - State tracking in GameEngine
       - Logic in actions/ComplicationManager
       - Comments referencing "primed"

    These represent LASER system state - charge level and groups ready to pop.
  </action>
  <verify>grep -rE "laserCapacitor|primedGroups" --include="*.ts" --include="*.tsx" . | grep -v node_modules returns no matches</verify>
  <done>Laser terminology updated: laserCharge, prePoppedGoopGroups.</done>
</task>

<task type="auto">
  <name>Task 3: Rename groupId and action constants</name>
  <files>core/gameLogic.ts, core/commands/actions.ts, core/events/GameEvents.ts, components/*.tsx</files>
  <action>
    1. Rename groupId -> goopGroupId (62 refs):
       - gameLogic.ts (27 refs) - most usages
       - inputs handling (10 refs)
       - goopRenderer.tsx (9 refs)
       - Type definitions in types.ts

    2. Rename action constants (in actions.ts and events):
       - MOVE_BOARD -> SPIN_TANK
       - ROTATE_PIECE -> ROTATE_GOOP
       - BLOCK_TAP -> POP_GOOP

    Note: These affect event subscriptions - update both emitters and listeners.
  </action>
  <verify>grep -rE "groupId[^a-zA-Z]|MOVE_BOARD|ROTATE_PIECE|BLOCK_TAP" --include="*.ts" --include="*.tsx" . | grep -v node_modules returns no matches</verify>
  <done>groupId -> goopGroupId and action constants renamed.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes with no errors
- [ ] `npm run test:run` passes all tests
- [ ] grep "ComplicationType" returns no matches
- [ ] grep "laserCapacitor" returns no matches
- [ ] grep "primedGroups" returns no matches
- [ ] grep "groupId" (word boundary) returns no matches
- [ ] grep "MOVE_BOARD|ROTATE_PIECE|BLOCK_TAP" returns no matches
- [ ] Complications trigger correctly in-game
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Zero references to old terms
- Tests pass
- TypeScript compiles clean
</success_criteria>

<output>
After completion, create `.planning/phases/23-code-rename/23-04-SUMMARY.md`
</output>
