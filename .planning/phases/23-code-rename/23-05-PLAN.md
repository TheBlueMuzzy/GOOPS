---
phase: 23-code-rename
plan: 05
type: execute
---

<objective>
Rename Progression system variables and timing constants.

Purpose: Establish official progression terminology (operatorRank, sessionXP, scraps).
Output: All scoring and progression variables use glossary terms.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/GLOSSARY.md
@.planning/phases/23-code-rename/23-04-SUMMARY.md

**Key files to modify:**
@App.tsx - State management
@core/GameEngine.ts - Score/time tracking
@utils/progression.ts - Rank calculations
@components/ConsoleView.tsx - Display
@components/UpgradePanel.tsx - Upgrade UI
@constants.ts - Timing constants

**Migration targets:**
- rank -> operatorRank (176 refs - scattered, context-dependent)
- totalScore -> operatorXP (28 refs)
- score -> sessionXP (76 refs)
- powerUpPoints -> scraps (21 refs)
- combo -> popStreak (22 refs)
- timeLeft -> sessionTime (29 refs)
- INITIAL_TIME_MS -> SESSION_DURATION (5 refs)
- INITIAL_SPEED -> ACTIVE_GOOP_SPEED (3 refs)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename scoring variables (score, totalScore, combo)</name>
  <files>core/GameEngine.ts, types.ts, App.tsx, components/*.tsx</files>
  <action>
    1. Rename score -> sessionXP (76 refs):
       - State field in GameEngine (18 refs)
       - Display in components
       - Test files
       - BE CAREFUL: "score" is a common word. Only rename game-score context.

    2. Rename totalScore -> operatorXP (28 refs):
       - Lifetime XP tracking in App/persistence
       - progression.ts calculations

    3. Rename combo -> popStreak (22 refs):
       - GameEngine state
       - Audio system (3 refs)
       - Controls/HUD display

    These are the core scoring variables displayed to players.
  </action>
  <verify>grep -rE "\.score[^A-Za-z]|totalScore|\.combo[^A-Za-z]" --include="*.ts" --include="*.tsx" . | grep -v node_modules returns only false positives</verify>
  <done>score -> sessionXP, totalScore -> operatorXP, combo -> popStreak complete.</done>
</task>

<task type="auto">
  <name>Task 2: Rename powerUpPoints to scraps and rank to operatorRank</name>
  <files>App.tsx, components/ConsoleView.tsx, components/UpgradePanel.tsx, utils/progression.ts</files>
  <action>
    1. Rename powerUpPoints -> scraps (21 refs):
       - App.tsx (6 refs) - state management
       - ConsoleView.tsx (5 refs) - display
       - UpgradePanel.tsx (4 refs) - upgrade purchasing
       - Types and persistence

    2. Rename rank -> operatorRank (176 refs):
       - This is SCATTERED across many files
       - State field, function params, display logic
       - BE CAREFUL: "rank" alone is a common word
       - Focus on game-context usages (e.g., state.rank, getRank, etc.)
       - Variable names like `rank` in function params need context review

    Note: rank is heavily used. May need multiple passes to catch all.
  </action>
  <verify>grep -rE "powerUpPoints|state\.rank[^A-Za-z]|getRank|currentRank" --include="*.ts" --include="*.tsx" . | grep -v node_modules shows only renamed versions</verify>
  <done>powerUpPoints -> scraps, rank -> operatorRank (where appropriate).</done>
</task>

<task type="auto">
  <name>Task 3: Rename timing variables and constants</name>
  <files>constants.ts, core/GameEngine.ts, core/gameLogic.ts, core/GoalManager.ts</files>
  <action>
    1. In constants.ts:
       - INITIAL_TIME_MS -> SESSION_DURATION (5 refs)
       - INITIAL_SPEED -> ACTIVE_GOOP_SPEED (3 refs)

    2. Rename timeLeft -> sessionTime (29 refs):
       - GameEngine.ts (8 refs)
       - gameLogic.ts (4 refs)
       - GoalManager.ts (4 refs)
       - Display components

    These timing variables represent the game session duration and internal clock.
  </action>
  <verify>grep -rE "INITIAL_TIME_MS|INITIAL_SPEED|\.timeLeft[^A-Za-z]" --include="*.ts" --include="*.tsx" . | grep -v node_modules returns no matches</verify>
  <done>Timing constants and variables renamed.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes with no errors
- [ ] `npm run test:run` passes all tests
- [ ] grep "powerUpPoints" returns no matches
- [ ] grep "totalScore" returns no matches
- [ ] grep "INITIAL_TIME_MS|INITIAL_SPEED" returns no matches
- [ ] Score displays correctly in UI
- [ ] Rank progression works correctly
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Zero references to old terms (in game context)
- Tests pass
- TypeScript compiles clean
</success_criteria>

<output>
After completion, create `.planning/phases/23-code-rename/23-05-SUMMARY.md`
</output>
