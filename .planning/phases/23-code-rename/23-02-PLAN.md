---
phase: 23-code-rename
plan: 02
type: execute
---

<objective>
Rename all totalUnits terminology to totalBlocks throughout the codebase.

Purpose: Per GLOSSARY.md, "unit" is not an official term. "Block" is the correct term for the content of cells. These stats track blocks added/popped.
Output: All code uses "totalBlocks" terminology consistently.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/GLOSSARY.md
@.planning/phases/22-audit-glossary/AUDIT.md
@.planning/phases/23-code-rename/23-01-SUMMARY.md

**Reference Files (from AUDIT.md Priority 2):**
@src/types.ts
@src/core/GameEngine.ts
@src/core/commands/actions.ts

**Established patterns:**
- Rename type definitions first, then usages
- Run tests after completion
- This is smaller scope than Plan 01 (8 changes vs 30)

**From Plan 01:**
- softDrop -> fastDrop complete
- All tests passing
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename type definitions</name>
  <files>src/types.ts</files>
  <action>
    In types.ts (GameState interface):
    1. Line 242: Rename `totalUnitsAdded: number` to `totalBlocksAdded: number`
    2. Line 243: Rename `totalUnitsPopped: number` to `totalBlocksPopped: number`

    These are the type definitions that other code references.
  </action>
  <verify>npx tsc --noEmit shows errors for undefined totalUnits references (expected - we renamed the type but not usages yet)</verify>
  <done>Type definitions renamed. TypeScript errors expected until Task 2 completes.</done>
</task>

<task type="auto">
  <name>Task 2: Update all usages</name>
  <files>src/core/GameEngine.ts, src/core/commands/actions.ts</files>
  <action>
    1. In GameEngine.ts:
       - Line 131: `totalUnitsAdded: 0` -> `totalBlocksAdded: 0`
       - Line 132: `totalUnitsPopped: 0` -> `totalBlocksPopped: 0`
       - Line 280: `totalUnitsAdded: 0` -> `totalBlocksAdded: 0`
       - Line 281: `totalUnitsPopped: 0` -> `totalBlocksPopped: 0`

    2. In actions.ts:
       - Line 178: `engine.state.totalUnitsAdded +=` -> `engine.state.totalBlocksAdded +=`
       - Line 308: `engine.state.totalUnitsPopped +=` -> `engine.state.totalBlocksPopped +=`

    After this task, TypeScript should compile without errors.
  </action>
  <verify>npx tsc --noEmit passes with no errors</verify>
  <done>All usages updated. TypeScript compiles clean.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes
- [ ] `npm run test:run` passes all tests
- [ ] `grep -r "totalUnits" src/` returns no matches
- [ ] Game state correctly tracks blocks added/popped
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Zero references to "totalUnits" in src/
- Tests pass
- TypeScript compiles
- Phase 23 complete
</success_criteria>

<output>
After completion, create `.planning/phases/23-code-rename/23-02-SUMMARY.md`:

# Phase 23 Plan 02: totalUnits -> totalBlocks Summary

**[One-liner describing what shipped]**

## Accomplishments

- Renamed totalUnitsAdded to totalBlocksAdded in types and usages
- Renamed totalUnitsPopped to totalBlocksPopped in types and usages

## Files Modified

- [List each file with description]

## Decisions Made

[Any deviations or choices made during execution]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 23 complete. Ready for Phase 24 (UI & Documentation).
</output>
